<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en-US" xml:lang="en-US">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes" />
  <meta name="author" content="Jose Storopoli" />
  <meta name="author" content="Rik Huijzer" />
  <meta name="author" content="Lazaro Alonso" />
  <title>A Makie recipe for a DataFrame - Julia Data Science</title>
  <link rel="shortcut icon" type="image/png" href="/favicon.png"/>
  <link rel="stylesheet" href="/style.css"/>
    <script src="/mousetrap.min.js"></script>
    <style>
  @font-face {
    font-family: JuliaMono-Regular;
    src: url("/JuliaMono-Regular.woff2");
  }
  </style>
  <script src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-chtml-full.js" type="text/javascript"></script>
  <script defer type="text/javascript" src="https://api.pirsch.io/pirsch.js" id="pirschjs" data-code="eB2Isj56H4g6ndupKwaKyHau7lCkTsVV"></script>
<link rel="stylesheet" href="/github.min.css">
<script src="/highlight.min.js"></script>
<script src="/julia.min.js"></script>
<script>
document.addEventListener('DOMContentLoaded', (event) => {
    document.querySelectorAll('pre').forEach((el) => {
        hljs.highlightElement(el);
    });
});
</script>
 
</head>
<body>
<script>
function click_next() {
  var next = document.getElementById('nav-next');
  next.firstElementChild.nextElementSibling.click();
}
function click_prev() {
  var prev = document.getElementById('nav-prev');
  prev.firstElementChild.click();
}
Mousetrap.bind('right', click_next);
Mousetrap.bind('h', click_prev);
Mousetrap.bind('left', click_prev);
Mousetrap.bind('l', click_next);
</script>

<div class="books-container">
<aside class="books-menu">
<input type="checkbox" id="menu">
<label for="menu">☰</label>
<div class="books-title">
<a href="/">Julia Data Science</a>
</div><br />
<span class="books-subtitle">

</span>
<div class="books-menu-content">
<li><a class="menu-level-1" href="/preface"><b>1</b> Preface</a></li>
<li><a class="menu-level-2" href="/why_data_science"><b>1.1</b> What is Data Science?</a></li>
<li><a class="menu-level-2" href="/engineering"><b>1.2</b> Software Engineering</a></li>
<li><a class="menu-level-2" href="/acknowledgements"><b>1.3</b> Acknowledgements</a></li>
<li><a class="menu-level-1" href="/why_julia"><b>2</b> Why Julia?</a></li>
<li><a class="menu-level-2" href="/non-programmers"><b>2.1</b> For Non-Programmers</a></li>
<li><a class="menu-level-2" href="/programmers"><b>2.2</b> For Programmers</a></li>
<li><a class="menu-level-2" href="/julia_accomplish"><b>2.3</b> What Julia Aims to Accom..</a></li>
<li><a class="menu-level-2" href="/julia_wild"><b>2.4</b> Julia in the Wild</a></li>
<li><a class="menu-level-1" href="/julia_basics"><b>3</b> Julia Basics</a></li>
<li><a class="menu-level-2" href="/ide"><b>3.1</b> Development Environments</a></li>
<li><a class="menu-level-2" href="/syntax"><b>3.2</b> Language Syntax</a></li>
<li><a class="menu-level-2" href="/data_structures"><b>3.3</b> Native Data Structures</a></li>
<li><a class="menu-level-2" href="/filesystem"><b>3.4</b> Filesystem</a></li>
<li><a class="menu-level-2" href="/standardlibrary"><b>3.5</b> Julia Standard Library</a></li>
<li><a class="menu-level-1" href="/dataframes"><b>4</b> DataFrames.jl</a></li>
<li><a class="menu-level-2" href="/load_save"><b>4.1</b> Load and Save Files</a></li>
<li><a class="menu-level-2" href="/index-and-summarize"><b>4.2</b> Index and Summarize</a></li>
<li><a class="menu-level-2" href="/filter_subset"><b>4.3</b> Filter and Subset</a></li>
<li><a class="menu-level-2" href="/select"><b>4.4</b> Select</a></li>
<li><a class="menu-level-2" href="/missing_data"><b>4.5</b> Types and Missing Data</a></li>
<li><a class="menu-level-2" href="/join"><b>4.6</b> Join</a></li>
<li><a class="menu-level-2" href="/variable-transformations"><b>4.7</b> Variable Transformations</a></li>
<li><a class="menu-level-2" href="/groupby_combine"><b>4.8</b> Groupby and Combine</a></li>
<li><a class="menu-level-2" href="/df_performance"><b>4.9</b> Performance</a></li>
<li><a class="menu-level-1" href="/DataVisualizationMakie"><b>5</b> Data Visualization with Ma..</a></li>
<li><a class="menu-level-2" href="/cairomakie"><b>5.1</b> CairoMakie.jl</a></li>
<li><a class="menu-level-2" href="/datavisMakie_attributes"><b>5.2</b> Attributes</a></li>
<li><a class="menu-level-2" href="/themes"><b>5.3</b> Themes</a></li>
<li><a class="menu-level-2" href="/using-latexstrings.jl"><b>5.4</b> Using LaTeXStrings.jl</a></li>
<li><a class="menu-level-2" href="/makie_colors"><b>5.5</b> Colors and Colormaps</a></li>
<li><a class="menu-level-2" href="/makie_layouts"><b>5.6</b> Layouts</a></li>
<li><a class="menu-level-2" href="/glmakie"><b>5.7</b> GLMakie.jl</a></li>
<li><a class="menu-level-2" href="/recipe_df"><b>5.8</b> A Makie recipe for a Dat..</a></li>
<li><a class="menu-level-1" href="/appendix"><b>6</b> Appendix</a></li>
<li><a class="menu-level-2" href="/appendix_pkg"><b>6.1</b> Packages Versions</a></li>
<li><a class="menu-level-2" href="/notation"><b>6.2</b> Notation</a></li>
<li><a class="menu-level-1" href="/references"><b></b> References</a></li>
</div>
</aside>

<div class="books-content">
<h2 data-number="5.8" id="sec:recipe_df"><span class="header-section-number">5.8</span> A Makie recipe for a DataFrame</h2>
<p>Unlike other libraries that already support a wide set of input formats via recipes, i.e. <code>Plots.jl</code>, in <code>Makie.jl</code> most of the time we need to pass the raw data to functions. However, we can also define our own <code>recipe</code> in <code>Makie.jl</code>. A <code>recipe</code> is your own custom plotting type command. This extension is done just in <code>Makie.jl</code>, which means that making a new set of plotting rules for your own types is light, namely, you don’t need the complete plotting machinery available to define them. This is specially useful if you want to include your own plotting commands in one of your own packages. However, in order for them to work you will still need to use one of the backends, i.e., GLMakie or CairoMakie.</p>
<p>As an example we will code a small <strong>full recipe</strong> for a <code>DataFrame</code>. Please refer to the <a href="https://makie.juliaplots.org/stable/documentation/recipes/">documentation</a> for more details.</p>
<p>A Makie <code>recipe</code> consist of two parts, a plot <code>type</code> name defined via <code>@recipe</code> and a custom <code>plot!(::Makie.plot)</code> which creates the actual plot via plotting functions already defined.</p>
<pre class="language-julia"><code>@recipe(DfPlot, df) do scene
    Attributes(
        x = :A,
        y = :B,
        c = :C,
        color = :red,
        colormap = :plasma,
        markersize = 20,
        marker = :rect,
        colorrange = (0,1),
        label = &quot;&quot;,
    )
end</code></pre>
<p>Note that the macro <code>@recipe</code> will automatically create two new functions for us, <code>dfplot</code> and <code>dfplot!</code>, all lowercase from our type <code>DfPlot</code>. The first one will create a complete new figure whereas the second one will plot into the current axis or an axis of your choosing. This allows us to plot <code>DataFrame</code>s which contains columns named, <code>x</code>, <code>y</code>, <code>z</code>. Now, let’s take care of our plot definition. We will do a simple scatter plot:</p>
<pre><code>import Makie</code></pre>
<pre class="language-julia"><code>function Makie.plot!(p::DfPlot{&lt;:Tuple{&lt;:DataFrame}})
    df = p[:df][]
    x = getproperty(df, p[:x][])
    y = getproperty(df, p[:y][])
    c = getproperty(df, p[:c][])
    scatter!(p, x, y; color = c, markersize = p[:markersize][],
        colormap = p[:colormap][], marker = p[:marker][],
        colorrange = (minimum(x), maximum(c)), label = p[:label][])
    return p
end</code></pre>
<p>Note the extras <code>[]</code> at the end of each variable. Those are due to the fact that <em>recipes</em> in Makie are dynamic, meaning that our plots will update if our variables change. See <a href="https://makie.juliaplots.org/stable/documentation/nodes/">observables</a> to know more. Now, we apply our new plotting function to the following <code>DataFrame</code>:</p>
<pre class="language-julia"><code>df_recipe = DataFrame(A=randn(10), B=randn(10), C=rand(10))</code></pre>
<pre class="language-julia"><code>fig, ax, obj = dfplot(df_recipe; label = &quot;test&quot;)
axislegend()
Colorbar(fig[1,2], obj)
fig</code></pre>
<figure>
<img src="/im/dfRecipe.svg" id="fig:dfRecipe" style="width:60.0%" alt="Figure 47: DataFrames recipe." /><figcaption aria-hidden="true">Figure 47: DataFrames recipe.</figcaption>
</figure>
<p>The named attributes in the recipe allows us to pass custom names to our new plotting function. Namely:</p>
<pre class="language-julia"><code>df_names = DataFrame(a1=rand(100), a2=rand(100), a3=rand(100))</code></pre>
<p>and:</p>
<pre class="language-julia"><code>dfplot(df_names; x = :a1, y = :a2, c = :a3, marker = &#39;o&#39;,
    axis = (; aspect=1, xlabel = &quot;a1&quot;, ylabel = &quot;a2&quot;),
    figure = (; backgroundcolor = :grey90))</code></pre>
<figure>
<img src="/im/dfRecipeArgs.svg" id="fig:dfRecipeArgs" style="width:60.0%" alt="Figure 48: DataFrames recipe with arguments." /><figcaption aria-hidden="true">Figure 48: DataFrames recipe with arguments.</figcaption>
</figure>
<p>Note, that now we are calling by name each column as well as the marker type, allowing us to use this definition for different DataFrames. Additionally, all our previous options, i.e., <code>axis</code> or <code>figure</code> also work!</p>


<div class="bottom-nav">
    <p id="nav-prev" style="text-align: left;">
        <a class="menu-level-2" href="/glmakie"><b>5.7</b> GLMakie.jl</a> <kbd>←</kbd>
        <span id="nav-next" style="float: right;">
            <kbd>→</kbd> <a class="menu-level-1" href="/appendix"><b>6</b> Appendix</a>
        </span>
    </p>
</div>


<div class="license">
    <br/>
  <br/>
  <a href="http://creativecommons.org/licenses/by-nc-sa/4.0/">CC BY-NC-SA 4.0</a>
    Jose Storopoli, Rik Huijzer, Lazaro Alonso
</div>
</div>
</div>
</body>
</html>